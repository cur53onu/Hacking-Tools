#!/usr/bin/env python
import requests
from BeautifulSoup import BeautifulSoup
import urlparse
def request(url):
	try:
		return requests.get(url)
	except requests.exceptions.ConnectionError:
		pass

target_url = "http://10.0.2.4/mutillidae/index.php?page=dns-lookup.php"
response = request(target_url)
parsed_html = BeautifulSoup(response.content)
forms_list  = parsed_html.findAll("form")

for form in forms_list:
	action = form.get("action")
	post_url = urlparse.urljoin(target_url,action)
	method = form.get("method")
	inputs_list = form.findAll("input")
	post_data={}
	for input1 in inputs_list:
		input1_name=input1.get("name")
		input1_type=input1.get("type")
		input1_value=input1.get("value")
		if input1_type =="text":
			input1_value="test"
		post_data[input1_name]=input1_value
	res = requests.post(post_url,data=post_data)
	print(response.content)